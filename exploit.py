import requests
from bs4 import BeautifulSoup
import pandas as pd
from tabulate import tabulate

def find_cves():
	try:

    		cve = input("Enter the exploit: ")

    		search = requests.get('https://www.exploit-database.net/?search='+ cve).content
    		soup: BeautifulSoup = BeautifulSoup(search, "html.parser")
    		soup2 = soup.find_all("h3", class_="panel-title")
    		for x in soup2:
        		soup3 = x.find('b').text

    		res = []
    		title = BeautifulSoup(search, "html.parser")
    		for el in soup.find_all('a', class_="table-exploits"):
        		elt = el.get_text()
        		res.append(elt)


    		links = []
    		for link in soup.find_all('a', class_='table-exploits'):
        		eol = link.get('href')
        		eolt = "https://www.exploit-database.net/" + eol
        		links.append(eolt)


    		search3 = requests.get('https://www.exploit-database.net/?search=')
    		df_list = pd.read_html(search3.text)

    		data = {
            		'Title': res,
            		'Exploit' : links,
        		}
    #df = pd.DataFrame(df_list)
    		print(tabulate(data, headers='keys', tablefmt='psql'))
	except KeyboardInterrupt:
		print('[-]exiting....')

find_cves()
